/*
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 */


var url = require('url');
var hmacSHA256 = require('crypto-js/hmac-sha256');
var Base64 = require('crypto-js/enc-base64');

function signature(req, timestamp, accessKey, secretKey) {
const space = " ";
const newLine = "\n";
const originalUrl = url.parse(req.url);
let query = "";

for (var key in req.qs) {
if (req.qs.hasOwnProperty(key)) {
if (query === '') {
query += `${key}=${req.qs[key]}`;
} else {
query += `&${key}=${req.qs[key]}`;
}
}
}

const message = `${req.method}${space}${originalUrl.pathname}${ query != "" ? `?${query}` : ''}${newLine}${timestamp}${newLine}${accessKey}`;
const hmac = hmacSHA256(message, secretKey);

return Base64.stringify(hmac);
}

module.exports = signature;
